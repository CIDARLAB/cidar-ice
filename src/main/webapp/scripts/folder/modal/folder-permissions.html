<div class="modal-header">
    <button type="button" class="close" ng-click="closeModal()">&times;</button>
    <span class="bebas modal-title" style="color: #657B83;font-size: 19px">
        <i class="fa fa-share-alt"></i> &nbsp;Share <span
            style="color:#000000;">{{folder.folderName}}</span> With Others</span>
</div>

<div class="modal-body">
    <span class="cursor_pointer" ng-click="setPropagatePermission(folder)">
        <i class="fa fa-fw"
           ng-class="{'fa-square-o':!folder.propagatePermission, 'fa-check-square-o':folder.propagatePermission}"></i> Propagate permissions to contained parts
    </span>
    <i class="fa fa-question-circle opacity_hover"
       uib-tooltip="Persists permissions set below to any parts that are added to the folder; even after they are removed from the folder"
       tooltip-placement="right"></i>

    <br><br>

    <span class="text-muted font-90em">Current permissions: {{permissions.length | number}}</span>

    <div class="pull-right cursor_pointer" style="margin-right: 10px" ng-click="enablePublicRead(folder)">
        <i class="fa fa-fw fa-globe"></i>
        <small>Public Access</small>
    </div>

    <table cellpadding="0" cellspacing="0" style="width: 560px; border-top: 1px solid #CCCCCC">
        <tr>
            <td>
                <div style="overflow: auto; max-height: 200px; border-bottom: 1px solid #CCCCCC">

                    <table class="table table-hover">
                        <tr ng-repeat="permission in permissions | orderBy:id">
                            <td style="vertical-align: middle; width: 45px;">
                                <i class="fa font-14em"
                                   ng-class="{'fa-user': permission.article=='ACCOUNT', 'fa-group dark-orange':permission.article=='GROUP'}"></i>
                            </td>
                            <td style="vertical-align: middle; line-height: 120%">
                                {{permission.display}}<br>
                                <small class="text-muted" ng-if="permission.account">{{permission.account.email}}
                                </small>
                                <small class="text-muted" ng-if="permission.group">{{permission.group.description |
                                    truncate:30}}
                                </small>
                            </td>
                            <td style="text-align: center; line-height: 90%">
                                <span>
                                   <i class="fa fa-fw  font-14em"
                                      ng-class="{'fa-eye': permission.canRead, 'fa-pencil': permission.canWrite}"></i>
                                    <br>
                                    <span class="opacity_hover">
                                        <small class="text-muted opacity_hover" ng-if="permission.canWrite">Can edit
                                        </small>
                                        <small class="text-muted opacity_hover" ng-if="permission.canRead">Can view
                                        </small>
                                        <span class="caret" ng-if="folder.canEdit"></span>
                                    </span>
                                </span>
                            </td>
                            <td style="width: 45px; vertical-align: middle">
                                <i class="fa fa-times delete_icon" ng-click="removePermission(permission)"></i>
                            </td>
                        </tr>
                    </table>
                </div>
            </td>
        </tr>

        <tr>
            <td class="permission_footer" style="border-left: 0; background-color: #f9f9f9">
                <span class="text-muted font-75em">Add {{newPermission.type}} permission</span> <br>

                <div class="btn-group" uib-dropdown>
                    <button class="btn btn-sm btn-default" uib-dropdown-toggle>
                        <i class="fa fa-fw font-14em"
                           ng-class="{'fa-user':newPermission.type=='account', 'fa-group':newPermission.type=='group', 'fa-globe':newPermission.type=='remote'}"></i>
                        <span class="caret"></span>
                    </button>

                    <ul uib-dropdown-menu>
                        <li><a href="#" ng-click="setPermissionType('account')"><i class="fa fa-fw fa-user"></i> Account</a>
                        </li>
                        <li><a href="#" ng-click="setPermissionType('group')"><i class="fa fa-fw fa-group"></i>
                            Group</a></li>
                        <li><a href="#" ng-click="setPermissionType('remote')"><i class="fa fa-fw fa-globe"></i> Remote
                            Account</a></li>
                    </ul>
                </div>

                <input type="text" class="input_box" style="width: 200px; padding: 6px"
                       placeholder="{{placeHolder}}" ng-model="userFilterInput"
                       typeahead-loading="loadingAddExistingData"
                       uib-typeahead="result[resultSubField] for result in filter($viewValue)"
                       typeahead-editable="true"
                       typeahead-on-select="userSelectionForPermissionAdd($item, $model, $label)">

                <div class="btn-group font-80em" style="border: 1px solid #fcfcfc">
                    <span class="cursor_pointer" ng-click="setPermission(false)">
                        <i class="fa fa-fw"
                           ng-class="{'fa-circle-o': !newPermission.canRead, 'fa-check-circle' : newPermission.canRead}"></i>
                    Can view</span>
                    <br>

                    <span class="cursor_pointer" ng-click="setPermission(true)">
                        <i class="fa fa-fw" ng-class="{'fa-circle-o': !newPermission.canWrite,
                        'fa-check-circle' : newPermission.canWrite}"></i> Can edit
                    </span>
                </div>

                &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

                <div class="btn-group" ng-if="webPartners.length && newPermission.type == 'remote'" uib-dropdown>
                    <button type="button" class="btn btn-sm btn-link" uib-dropdown-toggle>
                        Select Registry <span class="caret"></span>
                    </button>

                    <ul uib-dropdown-menu>
                        <li ng-repeat="partner in webPartners">
                            <a href="#" class="font-85em" style="line-height: 95%">{{partner.name}}<br>
                                <small class="text-muted">{{partner.url}}</small>
                            </a>
                        </li>
                    </ul>
                </div>

                <button type="button" ng-disabled="!newPermission.articleId" ng-click="addNewPermission()"
                        class="btn btn-sm btn-primary pull-right">Add
                </button>
            </td>
        </tr>
    </table>
</div>